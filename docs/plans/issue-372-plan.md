# Issue #372 Implementation Plan

## 概要

`scripts/run.sh` においてIssue番号が正の整数であることを検証する入力バリデーションを追加する。

## 影響範囲

| ファイル | 変更内容 |
|----------|----------|
| `scripts/run.sh` | Issue番号の数値バリデーション追加 |
| `test/scripts/run.bats` | バリデーションテストの追加・更新 |

## 実装ステップ

### 1. バリデーション追加

`scripts/run.sh` の `main()` 関数内、Issue番号が空でないことをチェックした後に、数値バリデーションを追加する。

```bash
if [[ -z "$issue_number" ]]; then
    log_error "Issue number is required"
    usage >&2
    exit 1
fi

# 追加するコード
if [[ ! "$issue_number" =~ ^[0-9]+$ ]]; then
    log_error "Issue number must be a positive integer: $issue_number"
    exit 1
fi
```

### 2. テスト追加

`test/scripts/run.bats` に以下のテストケースを追加/更新:

1. 非数値（`abc`）でエラーになることを確認
2. 負の数（`-42`）でエラーになることを確認
3. 小数（`3.14`）でエラーになることを確認
4. 先頭に0がある数値（`007`）は許可
5. エラーメッセージが適切であることを確認

## テスト方針

- 単体テスト: `test/scripts/run.bats` で引数バリデーションをテスト
- 手動テスト: 非数値を渡してエラーメッセージを確認

## リスクと対策

| リスク | 対策 |
|--------|------|
| 既存のテストが失敗する可能性 | テスト実行前に全テストをパスしていることを確認 |
| 先頭ゼロの数値を拒否する可能性 | `^[0-9]+$` パターンは `007` を許可する |

## 見積もり

| 項目 | 時間 |
|------|------|
| 実装 | 15分 |
| テスト | 15分 |
| **合計** | **30分** |
